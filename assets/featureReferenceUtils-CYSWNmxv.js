import{eM as v,dq as b,fG as w,fH as q,fI as T,fJ as M,fK as h,fL as A,fM as H}from"./index-DH3BihQz.js";function K(e,r){return I(e)===I(r)}function I(e){if(e==null)return null;const r=e.layer!=null?e.layer.id:"";let t=null;return t=e.objectId!=null?e.objectId:e.layer!=null&&"objectIdField"in e.layer&&e.layer.objectIdField!=null&&e.attributes!=null?e.attributes[e.layer.objectIdField]:e.uid,t==null?null:`o-${r}-${t}`}const L={json:{write:{writer:O,target:{"feature.layerId":{type:[Number,String],isRequired:!0},"feature.objectId":{type:[Number,String],isRequired:!0}}},origins:{"web-scene":{read:P}}},clonable:"reference"};function O(e,r){e?.layer?.objectIdField!=null&&e.attributes!=null&&(r.feature={layerId:e.layer.id,objectId:e.attributes[e.layer.objectIdField]})}function P(e){if(e.layerId!=null&&e.objectId!=null)return{uid:null,layer:{id:e.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:e.objectId}}}function k(e,r,t,l){const{sceneIntersectionHelper:F}=e,{observer:j,observerFeatureId:c,targetFeatureId:d,target:y}=t;if(c==null&&d==null)return;l||(l=n=>n),v(o,j,y);const u=w(o),a=1;q(o,j,o,a/u);const N=T(o,y,G);r.options.store=2,F.intersectToolIntersectorRay(N,r);let m=null,g=null,i=null,s=null;for(const n of r.results.all){const S=h(n,e);if(S==null||n.distanceInRenderSpace==null)continue;const f=I(S);f!=null&&(c!=null&&f===c&&(m??=l(p(n,e,u)),n.distanceInRenderSpace-a<m&&(i=n)),d!=null&&f===d&&(g??=l(p(n,e,u)),s==null&&n.distanceInRenderSpace-a<u&&u-n.distanceInRenderSpace+a<g&&(s=n)))}const{observerAdjusted:R,targetAdjusted:$}=t;i?.getIntersectionPoint(R)?t.observerSurfaceNormal=i.getTransformedNormal(b()):t.observerSurfaceNormal=null,s?.getIntersectionPoint($)?t.targetSurfaceNormal=s.getTransformedNormal(b()):t.targetSurfaceNormal=null}function p(e,r,t){if(A(e)){const l=H(e,r);if(l!=null)return Math.min(l*x,t)}return 1e-5*t}const x=.05,G=M(),o=b();export{k as I,K as c,L as d,I as s};
